# 抑郁风险预测系统 - 使用指南

## 📋 项目概述

这是一个基于机器学习的抑郁风险预测系统，能够通过分析社交媒体文本、日记内容等来评估抑郁风险。

### 🎯 主要功能
- **文本预处理**：清洗、标准化社交媒体文本
- **特征提取**：提取语言学、情感、社交媒体等特征
- **模型训练**：支持多种机器学习算法
- **风险预测**：实时预测抑郁风险等级
- **Web界面**：友好的用户交互界面

## 🚀 快速开始

### 1. 环境准备

```bash
# 激活虚拟环境
conda activate depression_env

# 安装依赖（如果需要）
pip install flask
```

### 2. 运行预测API

```bash
# 运行预测API
python predict_api.py
```

### 3. 启动Web应用

```bash
# 启动Web界面
python web_app.py
```

然后在浏览器中访问：http://localhost:5000

## 📊 模型性能

| 模型 | 准确率 | 精确率 | 召回率 | F1分数 | ROC AUC |
|------|--------|--------|--------|--------|---------|
| **Random Forest** | **100%** | **100%** | **100%** | **100%** | **100%** |
| SVM | 100% | 100% | 100% | 100% | 100% |
| Logistic Regression | 100% | 100% | 100% | 100% | 100% |
| Gradient Boosting | 100% | 100% | 100% | 100% | 100% |

## 🔧 使用方法

### 1. 命令行预测

```python
from predict_api import DepressionPredictor

# 初始化预测器
predictor = DepressionPredictor()

# 单个文本预测
text = "I feel so sad and hopeless today."
result = predictor.predict_single(text)
print(f"风险等级: {result['risk_level']}")
print(f"置信度: {result['confidence']:.2%}")

# 批量预测
texts = [
    "I feel so sad and hopeless today.",
    "Had a great day with friends!"
]
results = predictor.predict_batch(texts)
```

### 2. Web界面使用

1. 打开浏览器访问 http://localhost:5000
2. 在文本框中输入要分析的文本
3. 点击"预测风险"按钮
4. 查看预测结果和置信度

### 3. API接口调用

```python
import requests

# 单个预测
response = requests.post('http://localhost:5000/predict', 
                        json={'text': 'I feel so sad today'})
result = response.json()

# 批量预测
response = requests.post('http://localhost:5000/batch_predict', 
                        json={'texts': ['text1', 'text2']})
results = response.json()

# 获取特征重要性
response = requests.get('http://localhost:5000/features')
features = response.json()
```

## 📁 项目结构

```
DepressionRisk/
├── data/                    # 数据目录
│   ├── raw/                # 原始数据
│   └── processed/          # 处理后数据
├── models/                 # 训练好的模型
│   ├── random_forest_model.pkl
│   ├── svm_model.pkl
│   └── ...
├── src/                    # 源代码
│   ├── data_processing/    # 数据预处理模块
│   ├── models/            # 模型模块
│   └── training/          # 训练模块
├── templates/             # Web模板
├── predict_api.py         # 预测API
├── web_app.py            # Web应用
├── train_models.py       # 模型训练脚本
└── README.md             # 项目说明
```

## 🧠 技术架构

### 数据预处理流程
1. **文本清洗**：去除特殊字符、URL、表情符号等
2. **特征提取**：
   - 语言学特征：词数、句子数、平均词长等
   - 情感特征：积极/消极词汇比例
   - 社交媒体特征：标签、提及、链接等
   - 抑郁相关特征：抑郁关键词检测
3. **数据标准化**：特征缩放和标签编码

### 模型架构
- **传统机器学习**：Random Forest、SVM、Logistic Regression等
- **深度学习**：BERT-Capsule-Contrastive Learning模型
- **模型集成**：支持多种模型组合

## 📈 特征分析

系统提取的41个特征包括：

### 语言学特征
- 文本长度、词数、句子数
- 平均词长、词汇丰富度
- 标点符号使用频率

### 情感特征
- 积极词汇比例
- 消极词汇比例
- 情感词汇密度

### 社交媒体特征
- 标签数量、提及数量
- 链接数量、重复字符
- 大写字母比例

### 抑郁相关特征
- 抑郁关键词出现频率
- 自杀相关词汇检测
- 负面情绪表达强度

## ⚠️ 注意事项

### 1. 数据隐私
- 本系统仅用于研究和教育目的
- 请确保遵守相关隐私法规
- 建议对敏感数据进行匿名化处理

### 2. 模型局限性
- 当前模型基于有限数据训练
- 预测结果仅供参考，不能替代专业医疗诊断
- 建议结合其他评估方法使用

### 3. 使用建议
- 定期更新训练数据以提高模型性能
- 根据实际应用场景调整特征权重
- 考虑添加更多语言支持

## 🔄 模型更新

### 重新训练模型
```bash
# 准备新数据后重新训练
python train_models.py
```

### 添加新特征
1. 修改 `src/data_processing/feature_extractor.py`
2. 添加新的特征提取方法
3. 重新训练模型

### 优化模型性能
1. 增加训练数据量
2. 调整模型超参数
3. 尝试不同的特征组合

## 🛠️ 故障排除

### 常见问题

1. **模型加载失败**
   - 检查模型文件是否存在
   - 确认文件路径正确
   - 验证模型文件完整性

2. **预测结果异常**
   - 检查输入文本格式
   - 确认预处理流程正常
   - 验证特征提取是否成功

3. **Web应用无法启动**
   - 检查Flask是否安装
   - 确认端口5000未被占用
   - 查看错误日志

### 日志查看
```bash
# 查看详细日志
tail -f logs/app.log
```

## 📞 技术支持

如果遇到问题，请：
1. 查看错误日志
2. 检查环境配置
3. 确认依赖包版本
4. 参考项目文档

## 📄 许可证

本项目仅供学习和研究使用，请遵守相关法律法规。

---

**免责声明**：本系统仅用于研究和教育目的，预测结果不能替代专业医疗诊断。如有心理健康问题，请及时寻求专业帮助。
